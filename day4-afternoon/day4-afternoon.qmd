---
title: "QBB2024-JHU - Day 4 (Linear Regression)"
author: "Javier Carpinteyro Ponce"
format: html
editor: visual
code-annotations: hover
date: 07/16/2024
editor_options: 
  chunk_output_type: console
toc: true
self-contained: true
---

## Linear Regression using R

```{r}
#| warning: false
#| echo: true

library(tidyverse)

iris_setosa <- iris %>% 
  filter(Species == "setosa")
head(iris_setosa)
ggplot(data = iris_setosa, mapping = aes(x = Sepal.Width, y = Sepal.Length)) +
  geom_point() + 
  stat_smooth(method = "lm")
  

model <- lm(data = iris_setosa,formula = "Sepal.Length ~ 1 + Sepal.Width")

summary(model)



```

## Working with the penguins data set

```{r}
#| warning: false
#| echo: true

library(palmerpenguins)
library(broom)

head(penguins)
glimpse(penguins)

# is there a relationship between bill length and depth

# this interpretation is not correct
lm(data = penguins,
   formula = bill_length_mm ~ 1 + bill_depth_mm) %>%
  summary()

# plot and color by species and fit a linear model for each species data
ggplot(data = penguins, 
       mapping = aes(x = bill_depth_mm,y = bill_length_mm,color = species)) +
  geom_point() +
  stat_smooth(method = "lm")
# plot and color by species and fit a linear data for the data as a whole
ggplot(data = penguins, 
       mapping = aes(x = bill_depth_mm,y = bill_length_mm)) +
  geom_point(aes(color = species)) +
  stat_smooth(method = "lm")

# Do it by species
lm(data = penguins %>% filter(species == "Adelie"),
   formula = bill_length_mm ~ 1 + bill_depth_mm) %>%
  summary()

# consider all species together
full_model <- lm(data = penguins,
   formula = bill_length_mm ~ 1 + bill_depth_mm + species)
summary(full_model)
reduced_model <- lm(data = penguins,
                    formula = bill_length_mm ~ 1, bill_depth_mm)
# to test a more general question
anova(full_model, reduced_model)

# consider all species together considering interactions of the predictor variables
lm(data = penguins,
   formula = bill_length_mm ~ 1 + bill_depth_mm * species) %>%
  summary()


# consider all species together and sex
lm(data = penguins,
   formula = bill_length_mm ~ 1 + bill_depth_mm + species + sex) %>%
  summary()
```
